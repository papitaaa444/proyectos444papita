<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Con amor para ti üå∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --rosa:#FF69B4; --rosa-claro:#FFB6C1; --magenta:#DB7093; --bg:#FFF0F5;
      --oscuro:#0b132b; --azul:#00d4ff; --verde:#1DB954; --gris:#121212; --oro:#FFD700;
    }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Georgia, serif; background: var(--bg); color:#333; }
    .pantalla { display:none; padding:26px; text-align:center; min-height:100vh; }
    .btn { margin:10px; padding:12px 20px; border:none; border-radius:10px; font-weight:bold; cursor:pointer; }
    .btn-primario { background: var(--rosa); color: white; }
    .btn-rosa { background: var(--rosa-claro); color:white; }
    .btn-verde { background: var(--verde); color:white; }
    .btn-azul { background: var(--azul); color:black; }
    canvas { border:2px solid #ffc0cb; background:transparent; border-radius:8px; }
    input { padding:10px; font-size:16px; border:2px solid #eee; border-radius:8px; text-align:center; }

    #juego3 { background: var(--oscuro); color:white; }
    #juego4 { background:#0d1b2a; color:white; }
    #juego5 { background:#FFF5EE; }
    #juego6 { background:#FFF9FB; }
    #juego7 { background:#121212; color:white; }
    #juego8 { background: var(--gris); color:white; }
    #juego10 { background:#000014; color:white; }
    #cartaFinal { background:#FFFAF0; }
  </style>
</head>
<body>

<!-- Bienvenida -->
<section id="bienvenida" class="pantalla" style="display:block;">
  <h1 style="color:var(--magenta)">Para mi persona favorita</h1>
  <p style="color:#BC8F8F">He preparado este peque√±o rinc√≥n para ti.<br>¬øMe permites mostrarte?</p>
  <button class="btn btn-rosa" onclick="mostrar('juego1')">Comenzar Viaje ‚ú®</button>
</section>

<!-- Juego 1: Rondas -->
<section id="juego1" class="pantalla">
  <h2 style="color:#CD5C5C">üíñ Primer Reto: Afecto</h2>

  <div id="ronda1">
    <h3>Ronda 1: Un besito ‚ù§Ô∏è</h3>
    <canvas id="canvasR1" width="600" height="260"></canvas>
    <p id="timerR1">‚è≥ 5s</p>
    <button class="btn btn-rosa" onclick="pasarRonda(1)">Siguiente ‚û°Ô∏è</button>
  </div>

  <div id="ronda2" style="display:none;">
    <h3>Ronda 2: Un abrazo üíú</h3>
    <canvas id="canvasR2" width="600" height="260"></canvas>
    <p id="timerR2">‚è≥ 5s</p>
    <button class="btn btn-rosa" onclick="pasarRonda(2)">Siguiente ‚û°Ô∏è</button>
  </div>

  <div id="ronda3" style="display:none;">
    <h3>Busca 5 corazones rosados üíó</h3>
    <canvas id="canvasCorazones" width="600" height="350"></canvas>
    <p id="puntos">Puntos: 0/5</p>
    <div style="display:flex; justify-content:center; gap:8px;">
      <button id="btnNext1" class="btn btn-primario" style="display:none;" onclick="mostrar('juego2')">Siguiente ‚û°Ô∏è</button>
      <button class="btn btn-rosa" onclick="mostrar('juego2')">Siguiente (manual) ‚û°Ô∏è</button>
    </div>
  </div>
</section>

<!-- Juego 2: Colores -->
<section id="juego2" class="pantalla">
  <h2 style="color:var(--magenta)">üé® Encuentra el color oculto</h2>
  <p id="intentos">Te quedan 3 intentos</p>
  <div id="opciones"></div>
  <p id="mensaje"></p>
</section>

<!-- Juego 3: Principito -->
<section id="juego3" class="pantalla">
  <h2>üöÄ Viaje Estelar (El Principito)</h2>
  <p id="frase"></p>
  <div id="opcionesPrincipito"></div>
  <p id="estado"></p>
</section>

<!-- Juego 4: Esquiva -->
<section id="juego4" class="pantalla">
  <h2>‚ú® PROTEGE NUESTRO CIELO ‚ú®</h2>
  <canvas id="canvasEsquiva" width="600" height="450"></canvas>
  <p id="energia">Energ√≠a del Amor: 0%</p>
</section>

<!-- Juego 5: Laberinto -->
<section id="juego5" class="pantalla">
  <h2>üíñ Laberinto M√°gico</h2>
  <p id="vidas">Vidas: ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è</p>
  <canvas id="canvasLaberinto" width="600" height="400"></canvas>
</section>

<!-- Juego 6: Jard√≠n -->
<section id="juego6" class="pantalla">
  <h2>üå∏ Jard√≠n Final üå∏</h2>
  <canvas id="canvasJardin" width="800" height="650"></canvas>
</section>

<!-- Juego 7: Trivia -->
<section id="juego7" class="pantalla">
  <h2>üéµ Trivia Musical üéµ</h2>
  <p id="pregunta"></p>
  <div id="opcionesTrivia"></div>
</section>

<!-- Juego 8: Completar letra -->
<section id="juego8" class="pantalla">
  <h2>üé§ Completa la letra üé§</h2>
  <p id="tituloLetra" style="font-style:italic; color:#cccccc"></p>
  <p id="fraseLetra" style="font-weight:bold"></p>
  <div id="opcionesLetra"></div>
</section>

<!-- Juego 9: Adivina artista -->
<section id="juego9" class="pantalla">
  <h2>üïµÔ∏è Adivina el Artista por Emojis</h2>
  <p id="emojiArtista" style="font-size:40px;"></p>
  <input id="entradaArtista" type="text" placeholder="Escribe tu respuesta..." />
  <button class="btn btn-verde" onclick="verificarArtista()">Comprobar</button>
  <p id="errorArtista" style="color:red;"></p>
</section>

<!-- Juego 10: Fuegos -->
<section id="juego10" class="pantalla">
  <h2 style="color:var(--oro)">üéâ ¬°Felicidades! üéâ</h2>
  <canvas id="canvasFuegos" width="800" height="650" style="background:#000014; border-color:#222;"></canvas>
  <button class="btn btn-rosa" onclick="mostrar('cartaFinal')">Abrir Carta Especial üíå</button>
</section>

<!-- Carta Final -->
<section id="cartaFinal" class="pantalla">
  <h2 style="color:var(--magenta); margin-bottom:12px;">Mi Carta Especial...</h2>
  <div style="position:relative; max-width:860px; margin:0 auto;">
    <canvas id="canvasCarta" width="820" height="520" style="background:#FFFAF0; border:none; border-radius:12px;"></canvas>
    <div style="
      position:absolute; left:50%; top:50%; transform:translate(-50%, -50%);
      width:620px; max-width:92%; background:#FFEFF4; border:2px solid #FFC0CB; border-radius:12px;
      box-shadow:0 10px 25px rgba(219,112,147,0.25); color:#505050; text-align:center; padding:22px;">
      <h3 style="margin:0 0 12px; color:#DB7093; font-family:Georgia, serif;">Mi carta especial...</h3>
      <div style="font-family:Verdana, sans-serif; font-size:14px; line-height:1.6; text-align:justify; color:#505050; max-height:280px; overflow:auto;">
        Quiz√° te demuestro muy poco y quiz√° esto no sea nada o, si lo es, no sea suficiente. No es que no quiera expresar o mostrar todo lo que siento.
        Realmente, hay muchas cosas que siento y que quisiera expresar, pero creo que de verdad me quedo corta, jajaja, ir√≥nico ¬øcierto?
        Haciendo esto cayeron varias de mis l√°grimas, no lo voy a negar. Muchas cosas me asustan y, entre esas, que me destrocen, porque una vez ya llegu√© a eso.
        Al menos, si llego a caer ah√≠ otra vez, que no sea por ti, por favor. Quiero algo bonito e igual siento que quiz√° si no funciona pueda ser porque soy yo el problema.
        Siendo as√≠, te pido disculpas, quiz√° por el miedo a llorar me limit√© a ciertas cosas. Bueno, pero quiero que sepas que hay muchos sentimientos,
        muchas emociones que me haces sentir. Me haces feliz y quiero poder hacerte igual de feliz. Gracias por estar y por aguantarme.
        S√© que me pongo tonta y sigo mejorando por ti para ser y poder entregarte lo mejor. ¬°Muakkkk!
      </div>
      <button class="btn btn-primario" style="margin-top:14px;" onclick="finalizarCarta()">Finalizar con un abrazo virtual ü§ó</button>
    </div>
  </div>
</section>

<script>
// Navegaci√≥n ‚Äî disponible desde el inicio
function mostrar(id){
  document.querySelectorAll('.pantalla').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
}

// Botones de siguiente en Juego 1
function pasarRonda(n){
  const r1 = document.getElementById("ronda1");
  const r2 = document.getElementById("ronda2");
  const r3 = document.getElementById("ronda3");
  if(n===1 && r1 && r2){ r1.style.display="none"; r2.style.display="block"; drawR2(); startTimerR2(); }
  if(n===2 && r2 && r3){ r2.style.display="none"; r3.style.display="block"; iniciarRonda3(); }
}

// Juego 1: Rondas 1 y 2
const c1 = document.getElementById("canvasR1"), r1ctx = c1.getContext("2d");
let heart1 = {x:300,y:140,emoji:"‚ù§Ô∏è"}, t1Interval = null;
function drawR1(){ r1ctx.clearRect(0,0,c1.width,c1.height); r1ctx.font="52px Arial"; r1ctx.fillText(heart1.emoji, heart1.x, heart1.y); }
function moveRandom1(){ heart1.x=Math.random()*520+40; heart1.y=Math.random()*180+40; drawR1(); }
c1.addEventListener("mousemove",(e)=>{const rect=c1.getBoundingClientRect();const x=e.clientX-rect.left,y=e.clientY-rect.top;if(Math.hypot(x-heart1.x,y-heart1.y)<45) moveRandom1();});
function startTimerR1(){ let t=5; document.getElementById("timerR1").innerText=`‚è≥ ${t}s`; clearInterval(t1Interval); t1Interval=setInterval(()=>{ t--; document.getElementById("timerR1").innerText=`‚è≥ ${t}s`; if(t<=0){ clearInterval(t1Interval); } },1000); }

const c2 = document.getElementById("canvasR2"), r2ctx = c2.getContext("2d");
let heart2 = {x:300,y:140,emoji:"üíú"}, t2Interval = null;
function drawR2(){ r2ctx.clearRect(0,0,c2.width,c2.height); r2ctx.font="52px Arial"; r2ctx.fillText(heart2.emoji, heart2.x, heart2.y); }
function moveRandom2(){ heart2.x=Math.random()*520+40; heart2.y=Math.random()*180+40; drawR2(); }
c2.addEventListener("mousemove",(e)=>{const rect=c2.getBoundingClientRect();const x=e.clientX-rect.left,y=e.clientY-rect.top;if(Math.hypot(x-heart2.x,y-heart2.y)<45) moveRandom2();});
function startTimerR2(){ let t=5; document.getElementById("timerR2").innerText=`‚è≥ ${t}s`; clearInterval(t2Interval); t2Interval=setInterval(()=>{ t--; document.getElementById("timerR2").innerText=`‚è≥ ${t}s`; if(t<=0){ clearInterval(t2Interval); } },1000); }

// Juego 1: Ronda 3 (atrapa 5 üíó)
const c3 = document.getElementById("canvasCorazones"), ctx3 = c3.getContext("2d");
let puntos=0, arr=[], spawnTimeout=null;
function drawR3(){ ctx3.clearRect(0,0,c3.width,c3.height); ctx3.font="36px Arial"; arr.forEach(c=>ctx3.fillText(c.t,c.x,c.y)); }
function spawnR3(){
  if(puntos>=5) return;
  const x=Math.random()*560+20, y=Math.random()*320+20;
  const tipos=["‚ù§Ô∏è","üíú","üíó","üå∏","‚ú®"]; const t=tipos[(Math.random()*tipos.length)|0];
  arr.push({x,y,t}); drawR3();
  spawnTimeout = setTimeout(spawnR3, 450);
}
c3.addEventListener("click",(e)=>{
  const rect=c3.getBoundingClientRect(); const x=e.clientX-rect.left, y=e.clientY-rect.top;
  let closest=-1, best=9999;
  arr.forEach((c,i)=>{const d=Math.hypot(x-c.x,y-c.y); if(d<best){best=d; closest=i;}});
  if(closest!==-1 && best<28){
    if(arr[closest].t==="üíó"){
      puntos++; document.getElementById("puntos").innerText=`Puntos: ${puntos}/5`;
      arr.splice(closest,1); drawR3();
      if(puntos>=5){ document.getElementById("btnNext1").style.display="inline-block"; clearTimeout(spawnTimeout); }
    } else { arr.splice(closest,1); drawR3(); }
  }
});
function iniciarRonda3(){
  puntos=0; arr=[]; document.getElementById("btnNext1").style.display="none"; document.getElementById("puntos").innerText="Puntos: 0/5";
  drawR3(); clearTimeout(spawnTimeout); spawnR3();
}

// Arranque al entrar a juego1
const obsJ1 = new MutationObserver(()=>{
  const j1 = document.getElementById("juego1");
  if(j1 && j1.style.display==="block"){
    document.getElementById("ronda1").style.display="block";
    document.getElementById("ronda2").style.display="none";
    document.getElementById("ronda3").style.display="none";
    drawR1(); startTimerR1();
  }
});
obsJ1.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});

// Juego 2: Colores
(function(){
  const intentosLbl = document.getElementById("intentos");
  const opcionesDiv = document.getElementById("opciones");
  const msg = document.getElementById("mensaje");
  let intentos = 3;
  const trollMsgs = [
    "¬øAzul como el mar? No creo... üåä",
    "El rojo es lindo, pero ¬øes ese? ‚ù§Ô∏è",
    "Verde esperanza... pero esperanza de ganar üåø"
  ];
  const opciones = [
    {n:"Azul", c:"#ADD8E6"},
    {n:"Rojo", c:"#FFB2B2"},
    {n:"Verde", c:"#C2F0C2"},
    {n:"Amarillo", c:"#FFFFE0"}
  ];
  opcionesDiv.innerHTML = opciones.map(o =>
    `<button class="btn" style="background:${o.c}; width:120px;" onclick="verificarColor('${o.n}')">${o.n}</button>`
  ).join("");
  window.verificarColor = (elegido) => {
    intentos--;
    if(intentos>0){
      msg.innerText = trollMsgs[(Math.random()*trollMsgs.length)|0];
      intentosLbl.innerText = `No... Intenta otra vez (${intentos})`;
    } else {
      opcionesDiv.innerHTML = "";
      intentosLbl.innerText = "¬°Se acabaron los intentos! ü§≠";
      const btn = document.createElement("button");
      btn.className="btn btn-rosa";
      btn.textContent = "Tap tap aqu√≠, te equivocaste,\nera el color de fondo ü§°";
      btn.onclick = () => {
        document.getElementById("juego2").innerHTML = `
          <h2 style="color:white; background:#FFC0CB; padding:50px; border-radius:12px;">¬°Era obvio! El color era ROSADO üíó</h2>
          <button class="btn btn-primario" onclick="mostrar('juego3')">Continuar ‚ú®</button>
        `;
      };
      opcionesDiv.appendChild(btn);
    }
  };
})();

// Juego 3: Principito
(function(){
  const frases = [
    {texto:"Lo esencial es invisible...", correcta:"a los ojos", opciones:["al coraz√≥n","a la mente","al alma"]},
    {texto:"Fue el tiempo que pasaste con tu...", correcta:"rosa", opciones:["planeta","zorro","orgullo"]},
    {texto:"Si vienes, por ejemplo, a las cuatro de la tarde, desde las tres empezar√© a ser...", correcta:"feliz", opciones:["puntual","inquieto","amigo"]},
    {texto:"Todas las personas mayores fueron al principio...", correcta:"ni√±os", opciones:["sabios","peque√±os","so√±adores"]}
  ];
  let idx = 0;
  function render(){
    if(idx>=frases.length){
      document.getElementById("juego3").innerHTML = `
        <h2 style="color:#ffca3a;">‚ú® ¬°Sabias palabras! ‚ú®</h2>
        <button class="btn btn-azul" onclick="mostrar('juego4')">Continuar el viaje üöÄ</button>
      `;
      return;
    }
    const f = frases[idx];
    document.getElementById("frase").innerText = `"${f.texto}"`;
    const all = [...f.opciones, f.correcta].sort(()=>Math.random()-0.5);
    document.getElementById("opcionesPrincipito").innerHTML = all.map(
      o => `<button class="btn" style="background:#1c2541; color:white;" onclick="verificarPrincipito('${o}')">${o}</button>`
    ).join(" ");
  }
  window.verificarPrincipito = (o)=>{
    const f = frases[idx];
    if(o===f.correcta){ document.getElementById("estado").innerText="‚úÖ Correcto"; idx++; setTimeout(render,450); }
    else { document.getElementById("estado").innerText="‚ùå Intenta de nuevo"; }
  };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego3").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 4: Esquiva
(function(){
  const canvas = document.getElementById("canvasEsquiva");
  const ctx = canvas.getContext("2d");
  const energiaLbl = document.getElementById("energia");
  const corazon = {x:300,y:350};
  let obstaculos = [], rayos = [], puntos = 0, jugando = true;

  canvas.addEventListener("mousemove", (e)=>{
    const r = canvas.getBoundingClientRect();
    corazon.x = e.clientX - r.left; corazon.y = e.clientY - r.top;
  });
  function clima(){
    if(!jugando) return;
    const x = Math.random()*580+20;
    const tipos = ["‚òÅÔ∏è","‚õàÔ∏è","‚ùÑÔ∏è"];
    obstaculos.push({x:x, y:-50, tipo:tipos[(Math.random()*tipos.length)|0], vy:6+Math.random()*5, vx:(Math.random()*8-4)});
    if(Math.random()<0.3){
      const y = Math.random()*350+50; rayos.push({x:-50,y});
    }
    setTimeout(clima,220);
  }
  function frame(){
    ctx.clearRect(0,0,600,450);
    ctx.font="28px Arial"; ctx.fillText("‚ù§Ô∏è",corazon.x,corazon.y);
    obstaculos.forEach(o=>{
      ctx.font="35px Arial"; ctx.fillText(o.tipo,o.x,o.y);
      o.x+=o.vx; o.y+=o.vy;
      if(Math.abs(corazon.x-o.x)<35 && Math.abs(corazon.y-o.y)<35) puntos=Math.max(0,puntos-6);
    });
    obstaculos = obstaculos.filter(o=>o.y<500);
    rayos.forEach(r=>{
      ctx.font="30px Arial"; ctx.fillStyle="#ffd60a"; ctx.fillText("‚ö°",r.x,r.y); ctx.fillStyle="black";
      r.x+=15; if(Math.abs(corazon.x-r.x)<30 && Math.abs(corazon.y-r.y)<30) puntos=Math.max(0,puntos-15);
    });
    rayos = rayos.filter(r=>r.x<650);
    puntos+=0.45; const energia = Math.min(100,puntos);
    energiaLbl.innerText = `Energ√≠a del Amor: ${Math.floor(energia)}%`;
    if(energia>=100){
      jugando=false;
      document.getElementById("juego4").innerHTML = `
        <h2 style="color:${getComputedStyle(document.documentElement).getPropertyValue('--azul')}">¬°CIELO DESPEJADO! ‚ú®</h2>
        <button class="btn btn-azul" onclick="mostrar('juego5')">SIGUIENTE RETO ‚ûî</button>
      `;
    } else { requestAnimationFrame(frame); }
  }
  const obs = new MutationObserver(()=>{
    if(document.getElementById("juego4").style.display==="block"){
      obstaculos=[]; rayos=[]; puntos=0; jugando=true; clima(); frame();
    }
  });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 5: Laberinto
(function(){
  const canvas = document.getElementById("canvasLaberinto");
  const ctx = canvas.getContext("2d");
  const vidasLbl = document.getElementById("vidas");
  let jugador={x:30,y:40}, vidas=3, jugando=true;
  const meta={x:530,y:340,w:50,h:50};
  let muros=[{x:0,y:100,w:450,h:15,dir:1},{x:150,y:200,w:450,h:15,dir:-1},{x:0,y:300,w:450,h:15,dir:1}];
  let obst=[{x:300,y:150,vx:8,vy:3,t:"‚ú®"},{x:300,y:250,vx:-8,vy:-3,t:"üí´"}];
  canvas.addEventListener("mousemove",(e)=>{const r=canvas.getBoundingClientRect(); jugador.x=e.clientX-r.left; jugador.y=e.clientY-r.top;});
  function morir(){ vidas--; vidasLbl.innerText="Vidas: "+("‚ù§Ô∏è ".repeat(vidas)); jugador.x=30; jugador.y=40; if(vidas<=0){ vidas=3; vidasLbl.innerText="Vidas: ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è"; } }
  function loop(){
    if(!jugando) return;
    ctx.clearRect(0,0,600,400);
    ctx.fillStyle="#FF1493"; ctx.beginPath(); ctx.arc(meta.x+25,meta.y+25,25,0,Math.PI*2); ctx.fill();
    ctx.font="22px Arial"; ctx.fillText("üíñ",jugador.x,jugador.y);
    ctx.fillStyle="#FF69B4";
    muros.forEach(m=>{
      ctx.fillRect(m.x,m.y,m.w,m.h);
      m.w += 2*m.dir; if(m.w>550||m.w<350) m.dir*=-1;
      if(jugador.x>m.x && jugador.x<m.x+m.w && jugador.y>m.y && jugador.y<m.y+m.h) morir();
    });
    obst.forEach(o=>{
      ctx.font="25px Arial"; ctx.fillText(o.t,o.x,o.y);
      o.x+=o.vx; o.y+=o.vy; if(o.x>580||o.x<20) o.vx*=-1; if(o.y>380||o.y<20) o.vy*=-1;
      if(Math.abs(jugador.x-o.x)<25 && Math.abs(jugador.y-o.y)<25) morir();
    });
    if(jugador.x>meta.x && jugador.x<meta.x+meta.w && jugador.y>meta.y && jugador.y<meta.y+meta.h){
      jugando=false;
      document.getElementById("juego5").innerHTML = `
        <h2 style="color:#FF69B4">¬°ERES INCRE√çBLE! ‚ù§Ô∏è</h2>
        <button class="btn btn-primario" onclick="mostrar('juego6')">VER REGALO FINAL üéÅ</button>
      `;
    } else { requestAnimationFrame(loop); }
  }
  const obs = new MutationObserver(()=>{
    if(document.getElementById("juego5").style.display==="block"){
      jugador={x:30,y:40}; vidas=3; jugando=true;
      muros=[{x:0,y:100,w:450,h:15,dir:1},{x:150,y:200,w:450,h:15,dir:-1},{x:0,y:300,w:450,h:15,dir:1}];
      obst=[{x:300,y:150,vx:8,vy:3,t:"‚ú®"},{x:300,y:250,vx:-8,vy:-3,t:"üí´"}];
      vidasLbl.innerText="Vidas: ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è"; loop();
    }
  }); obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 6: Jard√≠n final ‚Äî tulipanes estilizados
(function(){
  const canvas = document.getElementById("canvasJardin");
  const ctx = canvas.getContext("2d");
  const paleta=["#FFB6C1","#DB7093","#FF69B4","#FF1493","#FFC0CB"];

  function drawTulip(x,y,scale=1){
    ctx.strokeStyle="#5FA66B"; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x, y+100*scale); ctx.stroke();
    ctx.fillStyle="#6FBF73";
    ctx.beginPath(); ctx.ellipse(x-12, y+60, 20, 8, Math.PI/6, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.ellipse(x+12, y+70, 20, 8, -Math.PI/6, 0, Math.PI*2); ctx.fill();
    const c = paleta[(Math.random()*paleta.length)|0];
    ctx.fillStyle = c;
    // central
    ctx.beginPath(); ctx.moveTo(x, y);
    ctx.quadraticCurveTo(x-10*scale, y-30*scale, x, y-50*scale);
    ctx.quadraticCurveTo(x+10*scale, y-30*scale, x, y); ctx.fill();
    // izquierdo
    ctx.beginPath(); ctx.moveTo(x, y);
    ctx.quadraticCurveTo(x-25*scale, y-25*scale, x-10*scale, y-50*scale);
    ctx.quadraticCurveTo(x-5*scale, y-25*scale, x, y); ctx.fill();
    // derecho
    ctx.beginPath(); ctx.moveTo(x, y);
    ctx.quadraticCurveTo(x+25*scale, y-25*scale, x+10*scale, y-50*scale);
    ctx.quadraticCurveTo(x+5*scale, y-25*scale, x, y); ctx.fill();
  }

  function escena(){
    ctx.clearRect(0,0,800,650);
    ctx.fillStyle="#FFF9FB"; ctx.fillRect(0,0,800,650);
    for(let i=0;i<40;i++){
      ctx.strokeStyle = "rgba(255,182,193,0.35)";
      ctx.beginPath();
      const lx = Math.random()*800; const ly = Math.random()*300;
      ctx.moveTo(lx, ly); ctx.lineTo(lx, ly+Math.random()*40+10); ctx.stroke();
      ctx.fillStyle = "rgba(255,215,0,0.6)";
      ctx.font = "12px Arial"; ctx.fillText("‚ú¶", lx+Math.random()*6, ly+Math.random()*6);
    }
    ctx.fillStyle="#DB7093"; ctx.font="30px Georgia"; ctx.fillText("Para mi lugar seguro...",280,90);
    ctx.fillStyle="#BC8F8F"; ctx.font="16px Arial"; ctx.fillText("Eres lo m√°s bonito de mi vida.",300,130);
    for(let i=0;i<25;i++){ drawTulip(Math.random()*700+50, Math.random()*140+420, 1+Math.random()*0.3); }
  }

  const petals=[];
  function spawnPetal(){ const x = Math.random()*800, size = 12+Math.random()*10; petals.push({x, y:-20, size, vy:1.2+Math.random()*1.2, vx:(Math.random()*0.6-0.3)}); }
  function drawPetals(){
    petals.forEach(p=>{ ctx.font = `${p.size}px Arial`; ctx.fillText("üå∏", p.x, p.y); p.y += p.vy; p.x += p.vx; });
    for(let i=petals.length-1;i>=0;i--) if(petals[i].y>660) petals.splice(i,1);
  }
  function loop(){ escena(); drawPetals(); requestAnimationFrame(loop); }

  const obs = new MutationObserver(()=>{
    if(document.getElementById("juego6").style.display==="block"){
      petals.length=0; for(let i=0;i<20;i++) spawnPetal();
      if(!window._petalInterval) window._petalInterval = setInterval(spawnPetal, 500);
      loop();
    }
  }); obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 7: Trivia
(function(){
  const preguntas = [
    {p:"¬øQui√©n es conocido como el 'Rey del Pop'?", c:"Michael Jackson", o:["Elvis Presley","Michael Jackson","Prince","Bruno Mars"]},
    {p:"¬øA qu√© g√©nero pertenece 'Bohemian Rhapsody'?", c:"Rock", o:["Pop","Jazz","Rock","√ìpera"]},
    {p:"¬øA qui√©n apodan 'El Sol de M√©xico'?", c:"Luis Miguel", o:["Alejandro Fern√°ndez","Luis Miguel","Chayanne","Cristian Castro"]}
  ]; let idx=0;
  function render(){
    if(idx>=preguntas.length){
      document.getElementById("juego7").innerHTML = `
        <h2 style="color:${getComputedStyle(document.documentElement).getPropertyValue('--verde')}">¬°Has completado la Trivia Musical! üé∂</h2>
        <button class="btn btn-verde" onclick="mostrar('juego8')">Continuar ‚û°Ô∏è</button>
      `;
      return;
    }
    const q = preguntas[idx];
    document.getElementById("pregunta").innerText = q.p;
    document.getElementById("opcionesTrivia").innerHTML = q.o.map(
      opt => `<button class="btn" style="background:#282828; color:white;" onclick="verificarTrivia('${opt}')">${opt}</button>`
    ).join(" ");
  }
  window.verificarTrivia = (o)=>{ if(o===preguntas[idx].c){ idx++; render(); } else { alert("‚ùå Incorrecto, intenta otra vez"); } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego7").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 8: Completar letra
(function(){
  const retos = [
    {t:"Ahora te puedes marchar - Luis Miguel", l:"Si t√∫ me hubieras dicho siempre la verdad...", c:"si hubieras respondido cuando te llam√©", o:["si no te hubieras ido de mi lado","si hubieras respondido cuando te llam√©","si me hubieras amado un poco m√°s"]},
    {t:"Yellow - Coldplay", l:"Look at the stars, look how they shine for...", c:"you", o:["us","me","you"]}
  ]; let idx=0;
  function render(){
    if(idx>=retos.length){
      document.getElementById("juego8").innerHTML = `
        <h2 style="color:#FF4B2B">¬°Has completado el reto musical! üé∂</h2>
        <button class="btn btn-primario" onclick="mostrar('juego9')">Continuar ‚û°Ô∏è</button>
      `; return;
    }
    const r = retos[idx];
    document.getElementById("tituloLetra").innerText = r.t;
    document.getElementById("fraseLetra").innerText = r.l;
    document.getElementById("opcionesLetra").innerHTML = r.o.map(
      o=>`<button class="btn" style="background:#333; color:white; width:320px;" onclick="verificarLetra('${o}')">${o}</button>`
    ).join("<br/>");
  }
  window.verificarLetra = (o)=>{ if(o===retos[idx].c){ idx++; render(); } else { alert("‚ùå Incorrecto, intenta otra vez"); } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego8").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 9: Adivina artista
(function(){
  const retos = [
    {emoji:"‚òÄÔ∏è üá≤üáΩ üéôÔ∏è", c:"Luis Miguel"},
    {emoji:"üåô üé§ üë±üèª‚Äç‚ôÄÔ∏è üíÖ", c:"Ariana Grande"},
    {emoji:"üé∏ üé© üî´ üåπ", c:"Guns N' Roses"}
  ]; let idx=0;
  function render(){
    if(idx>=retos.length){
      document.getElementById("juego9").innerHTML = `
        <h2>üéâ ¬°Has adivinado todos los artistas! üéâ</h2>
        <button class="btn btn-primario" onclick="mostrar('juego10')">Continuar ‚û°Ô∏è</button>
      `; return;
    }
    const r = retos[idx]; document.getElementById("emojiArtista").innerText=r.emoji;
    document.getElementById("entradaArtista").value=""; document.getElementById("errorArtista").innerText="";
  }
  window.verificarArtista = ()=>{
    const r = retos[idx]; const v = document.getElementById("entradaArtista").value.trim().toLowerCase();
    if(v===r.c.toLowerCase()){ idx++; render(); } else { document.getElementById("errorArtista").innerText="¬°Casi! Intenta de nuevo"; }
  };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego9").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 10: Fuegos artificiales
(function(){
  const canvas = document.getElementById("canvasFuegos");
  const ctx = canvas.getContext("2d");
  let partes=[];

  function lanzar(){
    const x=Math.random()*canvas.width, y=Math.random()*300+120;
    const pal=["#FFD700","#FF4500","#FF00FF","#00FFFF","#ADFF2F","#FFFFFF"];
    const color = pal[(Math.random()*pal.length)|0];
    for(let i=0;i<85;i++){
      const speed = 2.2 + Math.random()*2.4;
      const ang = Math.random() * Math.PI * 2;
      partes.push({x,y,vx:Math.cos(ang)*speed,vy:Math.sin(ang)*speed,vida:90+Math.random()*40,color,size:2+Math.random()*2});
    }
    setTimeout(lanzar, 1200);
  }
  function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const grad = ctx.createRadialGradient(canvas.width/2, canvas.height/2, 0, canvas.width/2, canvas.height/2, canvas.height/1.2);
    grad.addColorStop(0,"#000010"); grad.addColorStop(1,"#000014");
    ctx.fillStyle = grad; ctx.fillRect(0,0,canvas.width,canvas.height);

    partes.forEach(p=>{
      ctx.globalAlpha = 0.85;
      ctx.beginPath(); ctx.fillStyle=p.color; ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
      p.x+=p.vx; p.y+=p.vy; p.vy+=0.02; p.vida--;
    });
    ctx.globalAlpha = 1;
    partes = partes.filter(p=>p.vida>0);
    requestAnimationFrame(loop);
  }
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego10").style.display==="block"){ partes=[]; lanzar(); loop(); } });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Carta Final
(function(){
  const canvas = document.getElementById("canvasCarta");
  const ctx = canvas.getContext("2d");
  let hearts=[], ticker, spawnInt;

  function newHeart(){
    const x=Math.random()*canvas.width, y=canvas.height+Math.random()*120, size=18+Math.random()*12;
    const vx=(Math.random()*1.0-0.5), vy=-(1.2+Math.random()*1.8);
    const col=["#FFB6C1","#FFC0CB","#DB7093"][(Math.random()*3)|0];
    hearts.push({x,y,size,vx,vy,col});
  }
  function drawHeart(h){ ctx.font=`${h.size}px Arial`; ctx.fillStyle=h.col; ctx.fillText("üíó",h.x,h.y); }
  function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let i=0;i<6;i++){ ctx.font="12px Arial"; ctx.fillStyle= "#FFD700"; ctx.fillText("‚ú®", Math.random()*canvas.width, Math.random()*canvas.height); }
    for(let i=hearts.length-1;i>=0;i--){
      const c=hearts[i]; c.x+=c.vx; c.y+=c.vy; drawHeart(c);
      if(c.y<-40) hearts.splice(i,1);
    }
    ticker = requestAnimationFrame(loop);
  }
  function start(){ hearts=[]; for(let i=0;i<28;i++) newHeart(); loop(); spawnInt = setInterval(newHeart,1200); }
  function stop(){ cancelAnimationFrame(ticker); clearInterval(spawnInt); }
  window.finalizarCarta = ()=>{
    stop();
    document.getElementById("cartaFinal").innerHTML = `
      <div style="height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; background:#FFFAF0; color:${getComputedStyle(document.documentElement).getPropertyValue('--magenta')}">
        <h2>Gracias por leer üíå</h2>
        <p style="color:#BC8F8F">‚ÄúLo esencial es invisible a los ojos‚Äù ‚ú®</p>
        <button class="btn btn-rosa" style="margin-top:14px;" onclick="mostrar('bienvenida')">Volver al inicio</button>
      </div>`;
  };
  const obs = new MutationObserver(()=>{ if(document.getElementById("cartaFinal").style.display==="block") start(); else stop(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();
</script>
</body>
</html>










