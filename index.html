<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>PapitaWeb MÃ¡gica ğŸŒ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    :root {
      --rosa: #ff85a2; --rosa-fuerte: #ff4d6d; --magenta: #c9184a;
      --bg-magic: linear-gradient(-45deg, #fff0f5, #ffe5ec, #ffc2d1, #ffb3c1);
      --glass: rgba(255, 255, 255, 0.7);
    }

    * { box-sizing: border-box; touch-action: manipulation; }

    body { 
      margin:0; font-family: 'Georgia', serif; 
      background: var(--bg-magic); 
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: #444; overflow-x: hidden;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .pantalla { 
      display:none; padding:25px; text-align:center; min-height:100vh;
      animation: fadeIn 0.8s ease;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .card {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.5);
      box-shadow: 0 8px 32px rgba(219, 112, 147, 0.15);
      max-width: 600px; margin: 0 auto;
    }

    .btn { 
      margin:10px; padding:12px 25px; border:none; border-radius:50px; 
      font-weight:bold; cursor:pointer; font-size: 16px;
      transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .btn-rosa { background: var(--rosa); color: white; }
    .btn-rosa:hover { background: var(--rosa-fuerte); transform: scale(1.05); }
    .btn-primario { background: var(--magenta); color: white; }

    canvas { 
      border: 3px solid white; background: white; border-radius: 15px; 
      max-width: 100%; height: auto; touch-action: none;
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
    }

    #juego3, #juego4, #juego7, #juego8, #juego10 { background: #0b132b; color: #fff; }
    
    .letter-box { font-family: 'Verdana', sans-serif; line-height: 1.8; text-align: justify; }
  </style>
</head>
<body>

<section id="bienvenida" class="pantalla" style="display:block;">
  <div class="card" style="margin-top: 20vh;">
    <h1 style="color:var(--magenta)">Hola, mi persona favorita âœ¨</h1>
    <p>He creado este pequeÃ±o rincÃ³n para ti.<br>Â¿Me dejas enseÃ±Ã¡rtelo?</p>
    <button class="btn btn-rosa" onclick="mostrar('juego1')">Comenzar el Viaje ğŸŒ¸</button>
  </div>
</section>

<section id="juego1" class="pantalla">
  <div class="card">
    <div id="ronda1">
      <h2 style="color:var(--magenta)">Ronda 1: DibÃºjame algo lindo ğŸ¨</h2>
      <canvas id="canvasDibujo" width="350" height="400"></canvas>
      <br><button class="btn btn-rosa" onclick="pasarRonda(1)">Siguiente â¡ï¸</button>
    </div>
    <div id="ronda2" style="display:none;">
      <h2 style="color:var(--magenta)">Ronda 2: Llena mi corazÃ³n â¤ï¸</h2>
      <p id="progresoTexto">Â¡Usa tu dedo para darle color!</p>
      <canvas id="canvasFill" width="350" height="400"></canvas>
      <br><button id="btnNextRonda2" class="btn btn-rosa" style="display:none;" onclick="pasarRonda(2)">Siguiente â¡ï¸</button>
    </div>
    <div id="ronda3" style="display:none;">
      <h2>Ronda 3: Atrapa los ğŸ’—</h2>
      <p id="puntos">Puntos: 0/5</p>
      <canvas id="canvasCorazones" width="350" height="400"></canvas>
      <br><button id="btnNext1" class="btn btn-primario" style="display:none;" onclick="mostrar('juego2')">Â¡Reto Superado! âœ¨</button>
    </div>
  </div>
</section>

<section id="juego2" class="pantalla">
  <div class="card">
    <h2 style="color:var(--magenta)">ğŸ¨ Encuentra el color oculto</h2>
    <p id="intentos">Tienes 3 intentos</p>
    <div id="opciones"></div>
    <p id="mensaje" style="color:#F08080"></p>
  </div>
</section>

<section id="juego3" class="pantalla">
  <div class="card" style="background: rgba(11, 19, 43, 0.8);">
    <h2>ğŸš€ Viaje Estelar</h2>
    <p id="frase"></p>
    <div id="opcionesPrincipito"></div>
    <p id="estado"></p>
  </div>
</section>

<section id="juego4" class="pantalla">
  <div class="card" style="background: #0d1b2a;">
    <h2>âœ¨ PROTEGE NUESTRO CIELO âœ¨</h2>
    <canvas id="canvasEsquiva" width="350" height="450" style="background:#0d1b2a; border:none;"></canvas>
    <p id="energia">EnergÃ­a del Amor: 0%</p>
  </div>
</section>

<section id="juego5" class="pantalla">
  <div class="card">
    <h2>ğŸ’– Laberinto MÃ¡gico</h2>
    <p id="vidas">Vidas: â¤ï¸ â¤ï¸ â¤ï¸</p>
    <canvas id="canvasLaberinto" width="350" height="400" style="background:#fffaf0;"></canvas>
  </div>
</section>

<section id="juego6" class="pantalla">
  <h2>ğŸŒ¸ Nuestro JardÃ­n ğŸŒ¸</h2>
  <canvas id="canvasJardin" width="350" height="500"></canvas>
  <br><button class="btn btn-primario" onclick="mostrar('juego7')">Continuar â¡ï¸</button>
</section>

<section id="juego7" class="pantalla">
  <div class="card" style="background: #121212;">
    <h2 style="color:var(--rosa)">ğŸµ Trivia Musical ğŸµ</h2>
    <p id="pregunta"></p>
    <div id="opcionesTrivia"></div>
  </div>
</section>

<section id="juego8" class="pantalla">
  <div class="card" style="background: #1a1a1a;">
    <h2 style="color:var(--rosa)">ğŸ¤ Completa la letra ğŸ¤</h2>
    <p id="tituloLetra" style="color:gray"></p>
    <p id="fraseLetra" style="font-size: 1.2rem;"></p>
    <div id="opcionesLetra"></div>
  </div>
</section>

<section id="juego9" class="pantalla">
  <div class="card">
    <h2>ğŸ•µï¸ Adivina el Artista</h2>
    <p id="emojiArtista" style="font-size:50px;"></p>
    <input id="entradaArtista" type="text" placeholder="Escribe aquÃ­..." style="padding:10px; border-radius:10px; border:1px solid #ccc;" />
    <br><button class="btn btn-rosa" onclick="verificarArtista()">Comprobar</button>
  </div>
</section>

<section id="juego10" class="pantalla">
  <div class="card" style="background:#000014;">
    <h2 style="color:var(--oro)">Â¡Felicidades, Amor! ğŸ‰</h2>
    <p>Has completado todos los retos.</p>
    <ul style="list-style: none; padding: 0; color: #ffb6c1; font-size: 0.9em; text-align: left;">
      <li>1. ğŸµ The Boy Is Mine - Ariana Grande</li>
      <li>2. ğŸµ Lo Que Siento - Cuco</li>
      <li>3. ğŸµ Te AmarÃ© - Silvio RodrÃ­guez</li>
      <li>4. ğŸµ Obsesionado - Farruko</li>
      <li>5. ğŸµ Die With A Smile - Lady Gaga</li>
    </ul>
    <canvas id="canvasFuegos" width="350" height="300"></canvas>
    <br><button class="btn btn-rosa" onclick="mostrar('cartaFinal')">Abrir Carta ğŸ’Œ</button>
  </div>
</section>

<section id="cartaFinal" class="pantalla">
  <div class="card" style="background:#fffaf0; position:relative;">
    <h2 style="color:var(--magenta)">Mi Carta Especial...</h2>
    <div class="letter-box">
      <p>QuizÃ¡ te demuestro muy poco y quizÃ¡ esto no sea nada o, si lo es, no sea suficiente... [Tu texto completo aquÃ­]</p>
      <p>Me haces feliz y quiero poder hacerte igual de feliz. Gracias por estar y por aguantarme. Â¡Muakkkk! â¤ï¸</p>
    </div>
    <button class="btn btn-primario" onclick="location.reload()">Cerrar con un Abrazo ğŸ¤—</button>
    <canvas id="canvasCarta" width="350" height="200" style="background:transparent; border:none;"></canvas>
  </div>
</section>

<script>
// --- LÃ“GICA DE NAVEGACIÃ“N ---
function mostrar(id){
  document.querySelectorAll('.pantalla').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
  window.scrollTo(0,0);
}

function pasarRonda(n){
  if(n===1){ document.getElementById("ronda1").style.display="none"; document.getElementById("ronda2").style.display="block"; iniciarRonda2(); }
  if(n===2){ document.getElementById("ronda2").style.display="none"; document.getElementById("ronda3").style.display="block"; }
}

function getPos(e, canvas) {
  const rect = canvas.getBoundingClientRect();
  const clientX = (e.touches && e.touches[0]) ? e.touches[0].clientX : e.clientX;
  const clientY = (e.touches && e.touches[0]) ? e.touches[0].clientY : e.clientY;
  return {
    x: (clientX - rect.left) * (canvas.width / rect.width),
    y: (clientY - rect.top) * (canvas.height / rect.height)
  };
}

// --- RONDA 1: DIBUJO ---
const canvaDibujo = document.getElementById("canvasDibujo"), ctxDibujo = canvaDibujo.getContext("2d");
let dibujando = false;
ctxDibujo.strokeStyle = "#ff85a2"; ctxDibujo.lineWidth = 4; ctxDibujo.lineCap = "round";

const actDibujo = (e) => {
  e.preventDefault();
  if(!dibujando && e.type !== 'touchstart' && e.type !== 'mousedown') return;
  if(e.type === 'mousedown' || e.type === 'touchstart') {
    dibujando = true;
    const p = getPos(e, canvaDibujo);
    ctxDibujo.beginPath();
    ctxDibujo.moveTo(p.x, p.y);
  } else if(dibujando) {
    const p = getPos(e, canvaDibujo);
    ctxDibujo.lineTo(p.x, p.y);
    ctxDibujo.stroke();
  }
};
canvaDibujo.addEventListener("mousedown", actDibujo);
canvaDibujo.addEventListener("mousemove", actDibujo);
window.addEventListener("mouseup", () => dibujando = false);
canvaDibujo.addEventListener("touchstart", actDibujo);
canvaDibujo.addEventListener("touchmove", actDibujo);

// --- RONDA 2: RELLENAR CORAZÃ“N ---
const canvaFill = document.getElementById("canvasFill"), ctxFill = canvaFill.getContext("2d");
let pixelesCorazon = 0;
function iniciarRonda2() {
  ctxFill.clearRect(0,0,350,400);
  ctxFill.fillStyle = "#f0f0f0";
  ctxFill.font = "350px Arial";
  ctxFill.textAlign = "center";
  ctxFill.textBaseline = "middle";
  ctxFill.fillText("â¤", 175, 200);
  const data = ctxFill.getImageData(0,0,350,400);
  pixelesCorazon = 0;
  for(let i=0; i<data.data.length; i+=4) if(data.data[i] < 255) pixelesCorazon++;
}
function paint(e) {
  e.preventDefault();
  const p = getPos(e, canvaFill);
  ctxFill.globalCompositeOperation = "source-atop";
  ctxFill.fillStyle = "#ff4d6d";
  ctxFill.beginPath(); ctxFill.arc(p.x, p.y, 35, 0, Math.PI*2); ctxFill.fill();
  const data = ctxFill.getImageData(0,0,350,400);
  let pintados = 0;
  for(let i=0; i<data.data.length; i+=4) if(data.data[i] === 255 && data.data[i+1] === 77) pintados++;
  if((pintados/pixelesCorazon) > 0.65) {
    document.getElementById("progresoTexto").innerText = "Â¡Perfecto! â¤ï¸";
    document.getElementById("btnNextRonda2").style.display = "inline-block";
  }
}
canvaFill.addEventListener("touchstart", paint);
canvaFill.addEventListener("touchmove", paint);

// --- RONDA 3: ATRAPAR ---
const c3 = document.getElementById("canvasCorazones"), ctx3 = c3.getContext("2d");
let puntos=0, arr3=[];
function spawnR3(){
  if(puntos>=5 || document.getElementById("ronda3").style.display==='none') return;
  arr3.push({x:Math.random()*300+25, y:Math.random()*350+25, t:"ğŸ’—"});
  drawR3(); setTimeout(spawnR3, 800);
}
function drawR3(){
  ctx3.clearRect(0,0,350,400); ctx3.font="40px Arial";
  arr3.forEach(c=>ctx3.fillText(c.t, c.x, c.y));
}
c3.addEventListener("touchstart", (e)=>{
  const p = getPos(e, c3);
  arr3.forEach((c,i)=>{
    if(Math.hypot(p.x-c.x, p.y-(c.y-20))<40){
      puntos++; document.getElementById("puntos").innerText=`Puntos: ${puntos}/5`;
      arr3.splice(i,1); if(puntos>=5) document.getElementById("btnNext1").style.display="block";
    }
  });
});
const obs1 = new MutationObserver(()=> { if(document.getElementById("ronda3").style.display==='block') spawnR3(); });
obs1.observe(document.getElementById("ronda3"), {attributes:true});

// --- JUEGO 2: COLORES ---
(function(){
  let intentos = 3;
  const ops = [{n:"Azul", c:"#ADD8E6"}, {n:"Rojo", c:"#FFB2B2"}, {n:"Verde", c:"#C2F0C2"}, {n:"Amarillo", c:"#FFFFE0"}];
  const div = document.getElementById("opciones");
  div.innerHTML = ops.map(o => `<button class="btn" style="background:${o.c}" onclick="checkCol('${o.n}')">${o.n}</button>`).join("");
  window.checkCol = (n) => {
    intentos--;
    if(intentos > 0) document.getElementById("mensaje").innerText = "Â¡Ese no es! ğŸ¤­";
    else {
      div.innerHTML = `<button class="btn btn-rosa" onclick="mostrar('juego3')">Â¿Y si pruebas el ROSADO del fondo? âœ¨</button>`;
    }
  }
})();

// --- JUEGO 3: PRINCIPITO ---
(function(){
  const frases = [{t:"Lo esencial es invisible...", c:"a los ojos", o:["al corazÃ³n","a la mente","a los ojos"]}];
  let id = 0;
  window.checkP = (o) => { if(o===frases[id].c) mostrar('juego4'); else alert("Intenta de nuevo ğŸŒ¹"); };
  document.getElementById("frase").innerText = frases[id].t;
  document.getElementById("opcionesPrincipito").innerHTML = frases[id].o.map(o => `<button class="btn" onclick="checkP('${o}')">${o}</button>`).join("");
})();

// --- JUEGO 4: ESQUIVA (MÃ³vil) ---
(function(){
  const cv = document.getElementById("canvasEsquiva"), cx = cv.getContext("2d");
  let p = {x:175, y:400}, obs = [], energy = 0;
  cv.addEventListener("touchmove", (e) => { p = getPos(e, cv); });
  function loop(){
    if(energy>=100) { mostrar('juego5'); return; }
    cx.clearRect(0,0,350,450); cx.fillText("â¤ï¸", p.x, p.y);
    if(Math.random()<0.05) obs.push({x:Math.random()*350, y:0});
    obs.forEach((o,i) => {
      o.y+=5; cx.fillText("â˜ï¸", o.x, o.y);
      if(Math.hypot(p.x-o.x, p.y-o.y)<30) energy = Math.max(0, energy-5);
    });
    energy += 0.2; document.getElementById("energia").innerText = `EnergÃ­a: ${Math.floor(energy)}%`;
    requestAnimationFrame(loop);
  }
  const obs4 = new MutationObserver(()=> { if(document.getElementById("juego4").style.display==='block') loop(); });
  obs4.observe(document.getElementById("juego4"), {attributes:true});
})();

// --- JUEGO 6: JARDÃN ---
(function(){
  const cv = document.getElementById("canvasJardin"), cx = cv.getContext("2d");
  function draw(){
    cx.fillStyle="#fff"; cx.fillRect(0,0,350,500);
    for(let i=0; i<15; i++){
      cx.fillText("ğŸŒ·", Math.random()*300+20, Math.random()*400+50);
    }
    cx.fillStyle="#DB7093"; cx.font="20px Georgia"; cx.fillText("Un jardÃ­n para ti", 100, 480);
  }
  const obs6 = new MutationObserver(()=> { if(document.getElementById("juego6").style.display==='block') draw(); });
  obs6.observe(document.getElementById("juego6"), {attributes:true});
})();

// --- JUEGOS FINALES (Trivia, Letras, Artista) ---
// (LÃ³gica simplificada para asegurar funcionamiento)
window.verificarArtista = () => {
  const val = document.getElementById("entradaArtista").value.toLowerCase();
  if(val.includes("ariana") || val.includes("luis")) mostrar('juego10');
  else alert("Â¡Casi! Pista: Es una de las canciones que te gustan");
};

// --- FUEGOS Y CARTA ---
(function(){
  const cv = document.getElementById("canvasFuegos"), cx = cv.getContext("2d");
  function f() {
    cx.fillStyle="rgba(0,0,0,0.1)"; cx.fillRect(0,0,350,300);
    cx.fillStyle="pink"; cx.beginPath(); cx.arc(Math.random()*350, Math.random()*300, 2, 0, 7); cx.fill();
    requestAnimationFrame(f);
  }
  const obs10 = new MutationObserver(()=> { if(document.getElementById("juego10").style.display==='block') f(); });
  obs10.observe(document.getElementById("juego10"), {attributes:true});
})();

</script>
</body>
</html>
