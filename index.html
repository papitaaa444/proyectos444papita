<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Mi Persona Favorita üå∏</title>
    <style>
        :root {
            --rosa: #ff85a2; --rosa-fuerte: #ff4d6d; --magenta: #c9184a;
            --bg: linear-gradient(-45deg, #fff0f5, #ffe5ec, #ffc2d1, #ffb3c1);
            --glass: rgba(255, 255, 255, 0.85);
        }

        * { box-sizing: border-box; touch-action: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; font-family: 'Georgia', serif;
            background: var(--bg); background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #444; overflow: hidden; height: 100vh; width: 100vw;
        }

        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .pantalla {
            display: none; padding: 15px; text-align: center;
            height: 100vh; overflow-y: auto; animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        .card {
            background: var(--glass); backdrop-filter: blur(10px);
            border-radius: 25px; padding: 20px; border: 2px solid white;
            box-shadow: 0 10px 30px rgba(219, 112, 147, 0.2);
            max-width: 400px; margin: 10px auto;
        }

        .btn {
            margin: 8px; padding: 12px 20px; border: none; border-radius: 50px;
            font-weight: bold; cursor: pointer; font-size: 15px;
            background: var(--rosa); color: white; transition: 0.3s;
        }

        canvas {
            background: white; border-radius: 20px;
            width: 100%; height: auto; aspect-ratio: 1/1.2;
            border: 2px solid #ffc2d1; touch-action: none;
        }

        .dark-section { background: #000014 !important; color: white !important; }
        .dark-section .card { background: rgba(255,255,255,0.05); color: white; border-color: #333; }
        
        .song-list { text-align: left; font-size: 0.9em; color: #ffb6c1; list-style: none; padding: 0; }
        .song-list li { margin-bottom: 5px; }
    </style>
</head>
<body>

<section id="bienvenida" class="pantalla" style="display:block;">
    <div class="card" style="margin-top: 25vh;">
        <h1 style="color:var(--magenta)">¬°Hola, Mi Amor! ‚ú®</h1>
        <p>He preparado una aventura m√°gica solo para ti.<br>¬øEst√°s lista para empezar?</p>
        <button class="btn" onclick="mostrar('juego1')">¬°Empezar! üå∏</button>
    </div>
</section>

<section id="juego1" class="pantalla">
    <div class="card">
        <div id="ronda1">
            <h2>Dibuja algo lindo üé®</h2>
            <canvas id="canvasDibujo" width="350" height="420"></canvas>
            <br><button class="btn" onclick="pasarRonda(1)">Siguiente ‚û°Ô∏è</button>
        </div>
       // --- RONDA 2: RELLENAR CORAZ√ìN (VERSI√ìN ULTRA-COMPATIBLE) ---
const canvaF = document.getElementById("canvasFill"), ctxF = canvaF.getContext("2d");
let pixT = 0;

function iniciarRonda2() {
    ctxF.clearRect(0,0,350,420);
    ctxF.fillStyle = "#ebebeb"; // Gris muy claro
    ctxF.font = "380px Arial";
    ctxF.textAlign = "center";
    ctxF.textBaseline = "middle";
    ctxF.fillText("‚ù§", 175, 210);
    
    // Contamos el √°rea gris
    const d = ctxF.getImageData(0,0,350,420).data;
    pixT = 0; 
    for(let i=0; i<d.length; i+=4) {
        if(d[i] < 250) pixT++; // Cualquier p√≠xel que no sea blanco
    }
}

function paintF(e) {
    e.preventDefault();
    const p = getPos(e, canvaF);
    
    ctxF.globalCompositeOperation = "source-atop";
    ctxF.fillStyle = "#ff4d6d"; // El rosa
    ctxF.beginPath(); 
    ctxF.arc(p.x, p.y, 40, 0, Math.PI*2); // Pincel m√°s grande (40)
    ctxF.fill();
    
    // VERIFICACI√ìN FLEXIBLE:
    const imgData = ctxF.getImageData(0,0,350,420).data;
    let pintados = 0;
    for(let i=0; i<imgData.length; i+=4) {
        // Si el canal Rojo es alto (rosa/rojo) y no es el gris de fondo
        if(imgData[i] > 200 && imgData[i+1] < 150) {
            pintados++;
        }
    }
    
    let avance = (pintados / pixT);
    
    // Si llega al 50%, ya lo damos por bueno para evitar que se trabe
    if(avance > 0.50) {
        document.getElementById("progresoTexto").innerText = "¬°Llenito de amor! ‚ù§Ô∏è";
        document.getElementById("btnNextRonda2").style.display = "inline-block";
        
        // Efecto visual: rellenar autom√°ticamente el resto para que se vea perfecto
        ctxF.globalCompositeOperation = "source-atop";
        ctxF.fill(); 
    }
}

canvaF.addEventListener("touchstart", paintF);
canvaF.addEventListener("touchmove", paintF);
// Tambi√©n para mouse por si acaso
canvaF.addEventListener("mousedown", () => { canvaF._down = true; });
canvaF.addEventListener("mouseup", () => { canvaF._down = false; });
canvaF.addEventListener("mousemove", (e) => { if(canvaF._down) paintF(e); });
        <div id="ronda3" style="display:none;">
            <h2>Atrapa 5 corazones üíó</h2>
            <p id="puntos">Puntos: 0/5</p>
            <canvas id="canvasCorazones" width="350" height="420"></canvas>
            <br><button id="btnNext1" class="btn" style="display:none;" onclick="mostrar('juego2')">¬°Reto Superado! ‚ú®</button>
        </div>
    </div>
</section>

<section id="juego2" class="pantalla">
    <div class="card">
        <h2>üé® Color Oculto</h2>
        <div id="opcionesColores">
            <button class="btn" style="background:#ADD8E6" onclick="falloColor()">Azul</button>
            <button class="btn" style="background:#C2F0C2" onclick="falloColor()">Verde</button>
            <button class="btn" onclick="ganarColor()" id="btnRosa" style="display:none; background:var(--rosa)">¬°Rosa!</button>
        </div>
        <div id="secretoColor" style="display:none;">
            <p>¬°Exacto! El Rosa es el color de hoy ‚ú®</p>
            <button class="btn" onclick="mostrar('juego3')">Continuar</button>
        </div>
    </div>
</section>

<section id="juego3" class="pantalla dark-section">
    <div class="card">
        <h2>üåπ El Principito</h2>
        <p>"Lo esencial es invisible a..."</p>
        <button class="btn" onclick="alert('Casi...')">Los ojos</button>
        <button class="btn" onclick="mostrar('juego4')">Al coraz√≥n ‚ù§Ô∏è</button>
    </div>
</section>

<section id="juego4" class="pantalla dark-section">
    <div class="card">
        <h2>‚ú® Protege nuestro cielo</h2>
        <p id="energia">Energ√≠a del Amor: 0%</p>
        <canvas id="canvasEsquiva" width="350" height="420"></canvas>
    </div>
</section>

<section id="juego5" class="pantalla dark-section">
    <div class="card">
        <h2>üé§ Completa la Letra</h2>
        <p id="tituloCancion" style="color:var(--rosa)">Die With A Smile</p>
        <p>"If the world was ending, I'd wanna be..."</p>
        <button class="btn" onclick="mostrar('juego6')">Next to you üë©‚Äç‚ù§Ô∏è‚Äçüë®</button>
        <button class="btn" onclick="alert('¬°Nooo!')">Alone</button>
    </div>
</section>

<section id="juego6" class="pantalla">
    <div class="card">
        <h2>üïµÔ∏è Adivina el Artista</h2>
        <p style="font-size: 50px;">‚òÄÔ∏è üåä üï∂Ô∏è</p>
        <input type="text" id="inputArtista" placeholder="¬øQui√©n es?" style="padding:10px; border-radius:10px; border:1px solid #ccc; width:80%;">
        <br><br>
        <button class="btn" onclick="checkArtista()">Comprobar</button>
    </div>
</section>

<section id="juego7" class="pantalla dark-section">
    <div class="card">
        <h2 style="color:var(--rosa)">¬°LO LOGRASTE! üéâ</h2>
        <p>Estas son algunas de las canciones que me recuerdan a ti:</p>
        <ul class="song-list">
            <li>1. üéµ The Boy Is Mine - Ariana Grande</li>
            <li>2. üéµ Lo Que Siento - Cuco</li>
            <li>3. üéµ Te Amar√© - Silvio Rodr√≠guez</li>
            <li>4. üéµ Obsesionado - Farruko</li>
            <li>5. üéµ Die With A Smile - Lady Gaga</li>
        </ul>
        <canvas id="canvasFuegos" width="350" height="300" style="background:transparent; border:none;"></canvas>
        <br>
        <button class="btn" onclick="mostrar('cartaFinal')">Leer mi Carta üíå</button>
    </div>
</section>

<section id="cartaFinal" class="pantalla">
    <div class="card" style="background:#fffaf0; text-align: left; padding: 25px; border: 1px solid #ddd;">
        <h2 style="text-align:center; color:var(--magenta)">Para Ti ‚ù§Ô∏è</h2>
        <div style="line-height: 1.6; font-size: 0.95em;">
            <p>Quiz√° te demuestro muy poco y quiz√° esto no sea nada, pero para m√≠ lo es todo.</p>
            <p>Me haces feliz de una forma que no puedo explicar. Gracias por aguantarme, por estar ah√≠ y por ser t√∫.</p>
            <p>Eres mi persona favorita en todo el universo y siempre quiero que lo sepas.</p>
            <p style="text-align: right; font-weight: bold; color: var(--magenta); margin-top:20px;">Te quiero much√≠simo. <br> Siempre tuya. üå∏</p>
        </div>
        <button class="btn" style="width:100%" onclick="location.reload()">Recomenzar ü§ó</button>
    </div>
</section>

<script>
    function mostrar(id){
        document.querySelectorAll('.pantalla').forEach(p => p.style.display = 'none');
        document.getElementById(id).style.display = 'block';
        if(id === 'juego4') iniciarEsquiva();
        if(id === 'juego7') iniciarFuegos();
    }

    function getPos(e, canvas) {
        const rect = canvas.getBoundingClientRect();
        const touch = e.touches ? e.touches[0] : e;
        return {
            x: (touch.clientX - rect.left) * (canvas.width / rect.width),
            y: (touch.clientY - rect.top) * (canvas.height / rect.height)
        };
    }

    // --- DIBUJO ---
    const canvaD = document.getElementById("canvasDibujo"), ctxD = canvaD.getContext("2d");
    let dib = false;
    canvaD.addEventListener("touchstart", (e)=>{ e.preventDefault(); dib=true; const p=getPos(e,canvaD); ctxD.beginPath(); ctxD.moveTo(p.x,p.y); });
    canvaD.addEventListener("touchmove", (e)=>{ e.preventDefault(); if(!dib)return; const p=getPos(e,canvaD); ctxD.lineTo(p.x,p.y); ctxD.strokeStyle="#ff85a2"; ctxD.lineWidth=5; ctxD.stroke(); });
    canvaD.addEventListener("touchend", ()=>dib=false);

    // --- RELLENO ---
    const canvaF = document.getElementById("canvasFill"), ctxF = canvaF.getContext("2d");
    let pixT = 0;
    function iniciarRonda2() {
        ctxF.fillStyle="#f0f0f0"; ctxF.font="380px Arial"; ctxF.textAlign="center"; ctxF.textBaseline="middle";
        ctxF.fillText("‚ù§", 175, 210);
        const d = ctxF.getImageData(0,0,350,420).data;
        pixT=0; for(let i=0; i<d.length; i+=4) if(d[i]<255) pixT++;
    }
    canvaF.addEventListener("touchmove", (e)=>{
        e.preventDefault(); const p=getPos(e,canvaF);
        ctxF.globalCompositeOperation="source-atop"; ctxF.fillStyle="#ff4d6d";
        ctxF.beginPath(); ctxF.arc(p.x, p.y, 35, 0, Math.PI*2); ctxF.fill();
        const d = ctxF.getImageData(0,0,350,420).data;
        let ptd=0; for(let i=0; i<d.length; i+=4) if(d[i]===255 && d[i+1]===77) ptd++;
        if(ptd/pixT > 0.65) document.getElementById("btnNextRonda2").style.display="inline-block";
    });

    // --- ATRAPAR ---
    const canvaC = document.getElementById("canvasCorazones"), ctxC = canvaC.getContext("2d");
    let pts=0, listaC=[];
    function spawnC() {
        if(pts>=5 || document.getElementById("ronda3").style.display==='none') return;
        listaC.push({x:Math.random()*280+30, y:Math.random()*350+30});
        ctxC.clearRect(0,0,350,420); ctxC.font="40px Arial";
        listaC.forEach(c=>ctxC.fillText("üíó", c.x, c.y));
        setTimeout(spawnC, 800);
    }
    canvaC.addEventListener("touchstart", (e)=>{
        const p=getPos(e,canvaC);
        listaC.forEach((c,i)=>{ if(Math.hypot(p.x-c.x, p.y-(c.y-25))<45){ pts++; listaC.splice(i,1); document.getElementById("puntos").innerText=`Puntos: ${pts}/5`; if(pts>=5)document.getElementById("btnNext1").style.display="block"; } });
    });

    function pasarRonda(n) {
        if(n===1) { document.getElementById("ronda1").style.display="none"; document.getElementById("ronda2").style.display="block"; iniciarRonda2(); }
        if(n===2) { document.getElementById("ronda2").style.display="none"; document.getElementById("ronda3").style.display="block"; spawnC(); }
    }

    // --- ESQUIVA ---
    function iniciarEsquiva() {
        const cv=document.getElementById("canvasEsquiva"), cx=cv.getContext("2d");
        let en=0, player={x:175,y:350}, clouds=[];
        cv.addEventListener("touchmove", (e)=>{ player=getPos(e,cv); });
        function loop(){
            if(en>=100){ mostrar('juego5'); return; }
            cx.clearRect(0,0,350,420); cx.fillText("‚ù§Ô∏è", player.x-15, player.y);
            if(Math.random()<0.05) clouds.push({x:Math.random()*330, y:0});
            clouds.forEach((c,i)=>{ c.y+=5; cx.fillText("‚òÅÔ∏è", c.x, c.y); if(Math.hypot(player.x-c.x, player.y-c.y)<30) en=Math.max(0, en-8); });
            en+=0.3; document.getElementById("energia").innerText=`Energ√≠a: ${Math.floor(en)}%`;
            requestAnimationFrame(loop);
        }
        loop();
    }

    // --- FUEGOS ARTIFICIALES ---
    function iniciarFuegos() {
        const cv=document.getElementById("canvasFuegos"), cx=cv.getContext("2d");
        let particles = [];
        function createP() {
            for(let i=0; i<30; i++) particles.push({x:175, y:150, vx:(Math.random()-0.5)*10, vy:(Math.random()-0.5)*10, c:`hsl(${Math.random()*360},100%,70%)`});
        }
        setInterval(createP, 1000);
        function loop() {
            cx.fillStyle="rgba(0,0,14,0.2)"; cx.fillRect(0,0,350,300);
            particles.forEach((p,i)=>{ p.x+=p.vx; p.y+=p.vy; p.vy+=0.1; cx.fillStyle=p.c; cx.fillRect(p.x,p.y,3,3); if(p.y>300) particles.splice(i,1); });
            requestAnimationFrame(loop);
        }
        loop();
    }

    function falloColor() { document.getElementById("btnRosa").style.display="inline-block"; }
    function ganarColor() { document.getElementById("opcionesColores").style.display="none"; document.getElementById("secretoColor").style.display="block"; }
    function checkArtista() { if(document.getElementById("inputArtista").value.toLowerCase().includes("bad")) mostrar('juego7'); else alert("¬°Pista: El conejo malo!"); }
</script>
</body>
</html>

